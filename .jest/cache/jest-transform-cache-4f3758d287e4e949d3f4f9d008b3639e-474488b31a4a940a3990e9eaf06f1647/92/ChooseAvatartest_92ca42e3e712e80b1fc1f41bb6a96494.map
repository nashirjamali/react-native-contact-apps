{"version":3,"names":["_getJestObj","mock","postContact","jest","fn","putContact","_interopRequireDefault","require","_asyncToGenerator2","_react","_reactNative","_ChooseAvatar","_contact","_testUtils","_axios","_jsxRuntime","_require","mockedAxios","axios","createTestProps","props","Object","assign","navigation","navigate","describe","test","default","mockedResponse","data","status","statusText","headers","_renderWithProviders","renderWithProviders","jsx","route","key","name","params","isEdit","getByPlaceholderText","getByLabelText","getAllByTestId","waitFor","expect","toBeTruthy","fireEvent","press","accessibilityState","disabled","toBe","post","mockResolvedValueOnce","toHaveBeenCalledTimes","toHaveBeenCalledWith"],"sources":["ChooseAvatar.test.tsx"],"sourcesContent":["import React from 'react';\nimport {\n  render,\n  fireEvent,\n  waitFor,\n  screen,\n} from '@testing-library/react-native';\nimport {Provider} from 'react-redux';\nimport ChooseAvatar from '../ChooseAvatar';\nimport {postContact, putContact} from '../../apis/contact';\nimport {StackNavigationProp} from '@react-navigation/stack';\nimport {RootStackParamList} from '../../types';\nimport {renderWithProviders} from '../../utils/test-utils';\nimport axios, {AxiosResponse} from 'axios';\n\njest.mock('axios');\nconst mockedAxios = axios as jest.Mocked<typeof axios>;\n\njest.mock('../../apis/contact', () => ({\n  postContact: jest.fn(),\n  putContact: jest.fn(),\n}));\n\ntype NavigationProps = StackNavigationProp<RootStackParamList, 'ChooseAvatar'>;\n\nconst createTestProps = (props: Partial<NavigationProps>) => ({\n  navigation: {\n    navigate: jest.fn(),\n    ...props,\n  } as NavigationProps,\n  ...props,\n});\n\ndescribe('ChooseAvatar', () => {\n  test('navigates to List screen after successful contact creation', async () => {\n    const mockedResponse: AxiosResponse = {\n      data: {},\n      status: 200,\n      statusText: 'OK',\n      headers: {},\n    };\n\n    const props = createTestProps({});\n\n    const {getByPlaceholderText, getByLabelText, getAllByTestId} =\n      renderWithProviders(\n        <ChooseAvatar\n          route={{\n            key: 'ChooseAvatar',\n            name: 'ChooseAvatar',\n            params: {isEdit: false},\n          }}\n          {...props}\n        />,\n      );\n\n    await waitFor(() => {\n      expect(getAllByTestId('avatar-image')[0]).toBeTruthy();\n      expect(getByLabelText('button-save')).toBeTruthy();\n    });\n\n    fireEvent.press(getAllByTestId('avatar-image')[0]);\n\n    await waitFor(() => {\n      expect(\n        getByLabelText('button-save').props.accessibilityState.disabled,\n      ).toBe(false);\n    });\n\n    fireEvent.press(getByLabelText('button-save'));\n\n    mockedAxios.post.mockResolvedValueOnce(mockedResponse);\n\n    await waitFor(() => {\n      expect(postContact).toHaveBeenCalledTimes(1);\n      expect(props.navigation.navigate).toHaveBeenCalledWith('List');\n    });\n  });\n\n  //   test('navigates to List screen after successful contact update', async () => {\n  //     const navigationMock = {replace: jest.fn()};\n  //     const route = {params: {isEdit: true}};\n  //     const {getByText} = render(\n  //       <Provider store={store}>\n  //         <ChooseAvatar navigation={navigationMock} route={route} />\n  //       </Provider>,\n  //     );\n\n  //     const updateButton = getByText('Update');\n\n  //     fireEvent.press(updateButton);\n\n  //     await waitFor(() => {\n  //       expect(putContact).toHaveBeenCalledTimes(1);\n  //       expect(navigationMock.replace).toHaveBeenCalledWith('List');\n  //     });\n  //   });\n\n  //   test('displays error message when contact creation fails', async () => {\n  //     const navigationMock = {replace: jest.fn()};\n  //     const route = {params: {isEdit: false}};\n  //     const {getByText} = render(\n  //       <Provider store={store}>\n  //         <ChooseAvatar navigation={navigationMock} route={route} />\n  //       </Provider>,\n  //     );\n\n  //     const saveButton = getByText('Save');\n\n  //     postContact.mockRejectedValueOnce(new Error('Failed to create contact'));\n\n  //     fireEvent.press(saveButton);\n\n  //     await waitFor(() => {\n  //       expect(postContact).toHaveBeenCalledTimes(1);\n  //       expect(navigationMock.replace).not.toHaveBeenCalled();\n  //       expect(getByText('Error')).toBeTruthy();\n  //       expect(getByText('Failed to create contact')).toBeTruthy();\n  //     });\n  //   });\n\n  //   test('displays error message when contact update fails', async () => {\n  //     const navigationMock = {replace: jest.fn()};\n  //     const route = {params: {isEdit: true}};\n  //     const {getByText} = render(\n  //       <Provider store={store}>\n  //         <ChooseAvatar navigation={navigationMock} route={route} />\n  //       </Provider>,\n  //     );\n\n  //     const updateButton = getByText('Update');\n\n  //     putContact.mockRejectedValueOnce(new Error('Failed to update contact'));\n\n  //     fireEvent.press(updateButton);\n\n  //     await waitFor(() => {\n  //       expect(putContact).toHaveBeenCalledTimes(1);\n  //       expect(navigationMock.replace).not.toHaveBeenCalled();\n  //       expect(getByText('Error')).toBeTruthy();\n  //       expect(getByText('Failed to update contact')).toBeTruthy();\n  //     });\n  //   });\n});\n"],"mappings":"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"}